!function(e){var t;if("object"==typeof exports){try{t=require("jquery")}catch(e){}module.exports=e(window,document,t)}else window.Dropkick=e(window,document,window.jQuery)}((function(e,t,s,i){var a,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n=e.parent!==e.self&&location.host===parent.location.host,o=-1!==navigator.appVersion.indexOf("MSIE"),d=function(s,i){var a,l;if(this===e)return new d(s,i);for("string"==typeof s&&"#"===s[0]&&(s=t.getElementById(s.substr(1))),a=0;a<d.uid;a++)if((l=d.cache[a])instanceof d&&l.data.select===s)return c.extend(l.data.settings,i),l;return s?"SELECT"===s.nodeName?this.init(s,i):void 0:(console.error("You must pass a select to DropKick"),!1)},r=function(){},h={initialize:r,change:r,open:r,close:r,search:"strict",bubble:!0},c={hasClass:function(e,t){var s=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return e&&s.test(e.className)},addClass:function(e,t){e&&!c.hasClass(e,t)&&(e.className+=" "+t)},removeClass:function(e,t){var s=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e&&(e.className=e.className.replace(s," "))},toggleClass:function(e,t){var s=c.hasClass(e,t)?"remove":"add";c[s+"Class"](e,t)},extend:function(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){if(t)for(var s in t)e[s]=t[s]})),e},offset:function(s){var i=s.getBoundingClientRect()||{top:0,left:0},a=t.documentElement,l=o?a.scrollTop:e.pageYOffset,n=o?a.scrollLeft:e.pageXOffset;return{top:i.top+l-a.clientTop,left:i.left+n-a.clientLeft}},position:function(e,t){for(var s={top:0,left:0};e&&e!==t;)s.top+=e.offsetTop,s.left+=e.offsetLeft,e=e.parentNode;return s},closest:function(e,t){for(;e;){if(e===t)return e;e=e.parentNode}return!1},create:function(e,s){var i,a=t.createElement(e);for(i in s||(s={}),s)s.hasOwnProperty(i)&&("innerHTML"===i?a.innerHTML=s[i]:a.setAttribute(i,s[i]));return a},deferred:function(t){return function(){var s=arguments,i=this;e.setTimeout((function(){t.apply(i,s)}),1)}}};return d.cache={},d.uid=0,d.prototype={add:function(e,s){var i,a,l;"string"==typeof e&&(i=e,(e=t.createElement("option")).text=i),"OPTION"===e.nodeName&&(a=c.create("li",{class:"dk-option","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:"dk"+this.data.cacheID+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(a,e.className),this.length+=1,e.disabled&&(c.addClass(a,"dk-option-disabled"),a.setAttribute("aria-disabled","true")),this.data.select.add(e,s),"number"==typeof s&&(s=this.item(s)),this.options.indexOf(s)>-1?s.parentNode.insertBefore(a,s):this.data.elem.lastChild.appendChild(a),a.addEventListener("mouseover",this),l=this.options.indexOf(s),this.options.splice(l,0,a),e.selected&&this.select(l))},item:function(e){return e=e<0?this.options.length+e:e,this.options[e]||null},remove:function(e){var t=this.item(e);t.parentNode.removeChild(t),this.options.splice(e,1),this.data.select.remove(e),this.select(this.data.select.selectedIndex),this.length-=1},init:function(e,s){var i,o=d.build(e,"dk"+d.uid);if(this.data={},this.data.select=e,this.data.elem=o.elem,this.data.settings=c.extend({},h,s),this.disabled=e.disabled,this.form=e.form,this.length=e.length,this.multiple=e.multiple,this.options=o.options.slice(0),this.selectedIndex=e.selectedIndex,this.selectedOptions=o.selected.slice(0),this.value=e.value,this.data.cacheID=d.uid,d.cache[this.data.cacheID]=this,this.data.settings.initialize.call(this),d.uid+=1,this._changeListener||(e.addEventListener("change",this),this._changeListener=!0),!l||this.data.settings.mobile){if(e.parentNode.insertBefore(this.data.elem,e),e.setAttribute("data-dkCacheId",this.data.cacheID),this.data.elem.addEventListener("click",this),this.data.elem.addEventListener("keydown",this),this.data.elem.addEventListener("keypress",this),this.form&&this.form.addEventListener("reset",this),!this.multiple)for(i=0;i<this.options.length;i++)this.options[i].addEventListener("mouseover",this);a||(t.addEventListener("click",d.onDocClick),n&&parent.document.addEventListener("click",d.onDocClick),a=!0)}return this},close:function(){var e,t=this.data.elem;if(!this.isOpen||this.multiple)return!1;for(e=0;e<this.options.length;e++)c.removeClass(this.options[e],"dk-option-highlight");t.lastChild.setAttribute("aria-expanded","false"),c.removeClass(t.lastChild,"dk-select-options-highlight"),c.removeClass(t,"dk-select-open-(up|down)"),this.isOpen=!1,this.data.settings.close.call(this)},open:c.deferred((function(){var s,i,a,l,n=this.data.elem,d=n.lastChild;if(a=o?c.offset(n).top-t.documentElement.scrollTop:c.offset(n).top-e.scrollY,l=e.innerHeight-(a+n.offsetHeight),this.isOpen||this.multiple)return!1;d.style.display="block",s=d.offsetHeight,d.style.display="",i=a>s&&!(l>s)?"-up":"-down",this.isOpen=!0,c.addClass(n,"dk-select-open"+i),d.setAttribute("aria-expanded","true"),this._scrollTo(this.options.length-1),this._scrollTo(this.selectedIndex),this.data.settings.open.call(this)})),disable:function(e,t){var s="dk-option-disabled";0!==arguments.length&&"boolean"!=typeof e||(t=e===i,e=this.data.elem,s="dk-select-disabled",this.disabled=t),t===i&&(t=!0),"number"==typeof e&&(e=this.item(e)),c[t?"addClass":"removeClass"](e,s)},select:function(e,t){var s,i,a,l,n=this.data.select;if("number"==typeof e&&(e=this.item(e)),"string"==typeof e)for(s=0;s<this.length;s++)this.options[s].getAttribute("data-value")===e&&(e=this.options[s]);return!(!e||"string"==typeof e||!t&&c.hasClass(e,"dk-option-disabled"))&&(c.hasClass(e,"dk-option")?(i=this.options.indexOf(e),a=n.options[i],this.multiple?(c.toggleClass(e,"dk-option-selected"),a.selected=!a.selected,c.hasClass(e,"dk-option-selected")?(e.setAttribute("aria-selected","true"),this.selectedOptions.push(e)):(e.setAttribute("aria-selected","false"),i=this.selectedOptions.indexOf(e),this.selectedOptions.splice(i,1))):(l=this.data.elem.firstChild,this.selectedOptions.length&&(c.removeClass(this.selectedOptions[0],"dk-option-selected"),this.selectedOptions[0].setAttribute("aria-selected","false")),c.addClass(e,"dk-option-selected"),e.setAttribute("aria-selected","true"),l.setAttribute("aria-activedescendant",e.id),l.className="dk-selected "+a.className,l.innerHTML=a.text,this.selectedOptions[0]=e,a.selected=!0),this.selectedIndex=n.selectedIndex,this.value=n.value,t||this.data.select.dispatchEvent(new CustomEvent("change",{bubbles:this.data.settings.bubble})),e):void 0)},selectOne:function(e,t){return this.reset(!0),this._scrollTo(e),this.select(e,t)},search:function(e,t){var s,i,a,l,n,o,d,r,h=this.data.select.options,c=[];if(!e)return this.options;for(t="fuzzy"===(t=t?t.toLowerCase():"strict")?2:"partial"===t?1:0,r=new RegExp((t?"":"^")+e,"i"),s=0;s<h.length;s++)if(a=h[s].text.toLowerCase(),2==t){for(i=e.toLowerCase().split(""),l=n=o=d=0;n<a.length;)a[n]===i[l]?(o+=1+o,l++):o=0,d+=o,n++;l===i.length&&c.push({e:this.options[s],s:d,i:s})}else r.test(a)&&c.push(this.options[s]);return 2===t&&(c=c.sort((function(e,t){return t.s-e.s||e.i-t.i})).reduce((function(e,t){return e[e.length]=t.e,e}),[])),c},focus:function(){this.disabled||(this.multiple?this.data.elem:this.data.elem.children[0]).focus()},reset:function(e){var t,s=this.data.select;for(this.selectedOptions.length=0,t=0;t<s.options.length;t++)s.options[t].selected=!1,c.removeClass(this.options[t],"dk-option-selected"),this.options[t].setAttribute("aria-selected","false"),!e&&s.options[t].defaultSelected&&this.select(t,!0);this.selectedOptions.length||this.multiple||this.select(0,!0)},refresh:function(){this.dispose().init(this.data.select,this.data.settings)},dispose:function(){return delete d.cache[this.data.cacheID],l&&!this.data.settings.mobile||(this.data.elem.parentNode.removeChild(this.data.elem),this.data.select.removeAttribute("data-dkCacheId")),this},handleEvent:function(e){if(!this.disabled)switch(e.type){case"click":this._delegate(e);break;case"keydown":this._keyHandler(e);break;case"keypress":this._searchOptions(e);break;case"mouseover":this._highlight(e);break;case"reset":this.reset();break;case"change":this.data.settings.change.call(this)}},_delegate:function(t){var s,i,a,l,n=t.target;if(c.hasClass(n,"dk-option-disabled"))return!1;if(this.multiple){if(c.hasClass(n,"dk-option"))if("Range"===(s=e.getSelection()).type&&s.collapseToStart(),t.shiftKey)if(a=this.options.indexOf(this.selectedOptions[0]),l=this.options.indexOf(this.selectedOptions[this.selectedOptions.length-1]),(i=this.options.indexOf(n))>a&&i<l&&(i=a),i>l&&l>a&&(l=a),this.reset(!0),l>i)for(;i<l+1;)this.select(i++);else for(;i>l-1;)this.select(i--);else t.ctrlKey||t.metaKey||this.reset(!0),this.select(n)}else this[this.isOpen?"close":"open"](),c.hasClass(n,"dk-option")&&this.select(n)},_highlight:function(e){var t,s=e.target;if(!this.multiple){for(t=0;t<this.options.length;t++)c.removeClass(this.options[t],"dk-option-highlight");c.addClass(this.data.elem.lastChild,"dk-select-options-highlight"),c.addClass(s,"dk-option-highlight")}},_keyHandler:function(e){var t,s,i=this.selectedOptions,a=this.options,l=1,n=9,o=13,d=27,r=32,h=38,p=40;switch(e.keyCode){case h:l=-1;case p:if(e.preventDefault(),t=i[i.length-1],c.hasClass(this.data.elem.lastChild,"dk-select-options-highlight"))for(c.removeClass(this.data.elem.lastChild,"dk-select-options-highlight"),s=0;s<a.length;s++)c.hasClass(a[s],"dk-option-highlight")&&(c.removeClass(a[s],"dk-option-highlight"),t=a[s]);(l=a.indexOf(t)+l)>a.length-1?l=a.length-1:l<0&&(l=0),this.data.select.options[l].disabled||(this.reset(!0),this.select(l),this._scrollTo(l));break;case r:if(!this.isOpen){e.preventDefault(),this.open();break}case n:case o:for(l=0;l<a.length;l++)c.hasClass(a[l],"dk-option-highlight")&&this.select(l);case d:this.isOpen&&(e.preventDefault(),this.close())}},_searchOptions:function(e){var t,s=this,a=String.fromCharCode(e.keyCode||e.which);this.data.searchString===i&&(this.data.searchString=""),s.data.searchTimeout&&clearTimeout(s.data.searchTimeout),s.data.searchTimeout=setTimeout((function(){s.data.searchString=""}),1e3),this.data.searchString+=a,(t=this.search(this.data.searchString,this.data.settings.search)).length&&(c.hasClass(t[0],"dk-option-disabled")||this.selectOne(t[0]))},_scrollTo:function(e){var t,s,i=this.data.elem.lastChild;if(-1===e||"number"!=typeof e&&!e||!this.isOpen&&!this.multiple)return!1;"number"==typeof e&&(e=this.item(e)),(s=(t=c.position(e,i).top)-i.scrollTop)+e.offsetHeight>i.offsetHeight?(t+=e.offsetHeight,i.scrollTop=t-i.offsetHeight):s<0&&(i.scrollTop=t)}},d.build=function(e,t){var s,i,a,l=[],n={elem:null,options:[],selected:[]},o=function(e){var s,i,a,l,d=[];switch(e.nodeName){case"OPTION":s=c.create("li",{class:"dk-option ","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:t+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(s,e.className),e.disabled&&(c.addClass(s,"dk-option-disabled"),s.setAttribute("aria-disabled","true")),e.selected&&(c.addClass(s,"dk-option-selected"),s.setAttribute("aria-selected","true"),n.selected.push(s)),n.options.push(this.appendChild(s));break;case"OPTGROUP":for(i=c.create("li",{class:"dk-optgroup"}),e.label&&i.appendChild(c.create("div",{class:"dk-optgroup-label",innerHTML:e.label})),a=c.create("ul",{class:"dk-optgroup-options"}),l=e.children.length;l--;d.unshift(e.children[l]));d.forEach(o,a),this.appendChild(i).appendChild(a)}};for(n.elem=c.create("div",{class:"dk-select"+(e.multiple?"-multi":"")}),i=c.create("ul",{class:"dk-select-options",id:t+"-listbox",role:"listbox"}),e.disabled&&c.addClass(n.elem,"dk-select-disabled"),n.elem.id=t+(e.id?"-"+e.id:""),c.addClass(n.elem,e.className),e.multiple?(n.elem.setAttribute("tabindex",e.getAttribute("tabindex")||"0"),i.setAttribute("aria-multiselectable","true")):(s=e.options[e.selectedIndex],n.elem.appendChild(c.create("div",{class:"dk-selected "+s.className,tabindex:e.tabindex||0,innerHTML:s?s.text:"&nbsp;",id:t+"-combobox","aria-live":"assertive","aria-owns":i.id,role:"combobox"})),i.setAttribute("aria-expanded","false")),a=e.children.length;a--;l.unshift(e.children[a]));return l.forEach(o,n.elem.appendChild(i)),n},d.onDocClick=function(e){var t,s;if(1!==e.target.nodeType)return!1;for(s in null!==(t=e.target.getAttribute("data-dkcacheid"))&&d.cache[t].focus(),d.cache)c.closest(e.target,d.cache[s].data.elem)||s===t||d.cache[s].disabled||d.cache[s].close()},s!==i&&(s.fn.dropkick=function(){var e=Array.prototype.slice.call(arguments);return s(this).each((function(){e[0]&&"object"!=typeof e[0]?"string"==typeof e[0]&&d.prototype[e[0]].apply(new d(this),e.slice(1)):new d(this,e[0]||{})}))}),d}));